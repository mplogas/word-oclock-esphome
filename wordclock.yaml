## Word Clock v1 ESPHome Configuration File

esphome:
  name: word-clock-v1
  friendly_name: Word Clock V1
  includes:
    - components/wordclock/wordclock.h

esp8266:
  board: d1_mini  

logger:
  level: WARN

api:
  encryption:
    key: !secret api_key

ota:
  - platform: esphome
    password: !secret ota_password

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  use_address: 192.168.103.170
  min_auth_mode: WPA2

time:
  - platform: homeassistant
    id: home_time
    timezone: "Europe/Berlin"

light:
  - platform: neopixelbus
    type: GRB
    pin: D4  
    num_leds: 121  
    name: "Word Clock LEDs"
    id: word_clock_matrix
    variant: WS2812
    restore_mode: RESTORE_DEFAULT_OFF

external_components:
  - source: 
      type: local
      path: components

wordclock:
  id: word_clock_display
  time_id: home_time
  led_count: 121
  language: "de"
  light_id: word_clock_matrix
  switch_id: regional_format_switch

button:
  - platform: restart
    name: "Word Clock Restart"
    id: restart_button

switch:
  - platform: template
    name: "Regional Format"
    id: regional_format_switch
    optimistic: true
    restore_mode: RESTORE_DEFAULT_OFF

# Optional sensor to display the reported internal time string (for debugging)
text_sensor:
  - platform: template
    name: "Internal Word Clock Time"
    id: word_clock_time
    update_interval: 10s
    entity_category: "diagnostic"
    lambda: |-
      auto now = id(home_time).now();
      if (now.is_valid()) {
        char buffer[100];
        snprintf(buffer, sizeof(buffer), "%02d:%02d", 
                 now.hour, now.minute);
        return std::string(buffer);
      }
      return std::string("--:--:--");


    
